# Stage2 v2 (将来実装予定)

## 概要

このフォルダには、将来的に統合を検討している新設計のStage2実装が含まれています。
**現在は使用されていません。**

## 現行Stage2との違い

| 項目 | 現行 (02_main.py) | 新設計 (このフォルダ) |
|------|-------------------|----------------------|
| モデル | Logistic Regression | XGBoost |
| 予測対象 | p_error (Stage1の誤り確率) | p2 (フィッシング確率) |
| 閾値選択 | 手動設定 | Wilson bound (統計的保証) |
| ルール | 証明書ルール + TLDルール | シンプルな2閾値 |

## ファイル

- `stage2_decider_v2.py` - 新設計Stage2の実装

## 設計思想

```
Stage1 DEFER
    ↓
Stage2 v2 (XGBoost)
    ↓ p2を計算
┌─────────────────────────────────┐
│ p2 <= phi_low  → AUTO_BENIGN_2 │  ← Wilson boundでFN率を保証
│ p2 >= phi_high → AUTO_PHISH_2  │  ← 優先セグメントのみ
│ otherwise      → DEFER2        │  → Stage3 AI Agentへ
└─────────────────────────────────┘
```

## 統合の前提条件

1. Stage3 AI Agentの精度が安定していること
2. 新設計Stage2の独立評価が完了していること
3. 現行Stage2との性能比較が行われていること

## 参考

- 作成日: 2026-01-07
- 移動日: 2026-01-27
- 移動理由: 現行システムとの混乱を避けるため
