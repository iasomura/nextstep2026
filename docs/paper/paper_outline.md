# 論文骨子: 3段カスケード型フィッシング検出システム

**作成日**: 2026-02-06
**前論文**: CSS2025「機械学習とAIエージェントを組み合わせたハイブリッド型フィッシングサイト検出システムの開発と評価」

---

## CSS2025 → 新論文の進化ポイント

| 観点 | CSS2025 | 新論文 |
|------|---------|------|
| アーキテクチャ | 2段階（ML → AI Agent） | **3段階（ML → Gate/Rule → AI Agent + Rule Engine）** |
| データ規模 | 640,356件 | 127,754件（バランスデータ、全件評価） |
| Stage2 | なし | **35種ポリシールールによるフィルタリング（新規）** |
| AI Agent | LLM単体判定 | **LLM + ルールエンジン統合（新規）** |
| FNR | 6.58% → 1.04% | 5.11% → 2.32%（全件実測） |
| 偽陰性分析 | 記述的（3事例） | **体系的（ルール発火統計、検知パターン分類）** |
| 説明可能性 | reasoning出力のみ | **平均6.5個のリスク要因 + ルール発火トレース** |
| ルール設計 | インライン実装 | **モジュール化（テスト可能、個別有効/無効化）** |

---

## タイトル案

**日本語**:
「3段カスケード型ハイブリッドフィッシング検出システムにおけるルールエンジン統合の効果分析」

**英語**:
"Effect Analysis of Rule Engine Integration in a Three-Stage Cascade Hybrid Phishing Detection System"

**代替案**:
- 「証明書特徴に基づく3段カスケード型フィッシング検出における偽陰性の体系的分析」
- 「機械学習モデルの判定境界域における AI エージェントとルールエンジンの相補的検出効果」
- "Systematic Analysis of False Negatives in Three-Stage Cascade Phishing Detection Using Certificate Features"

---

## 論文構成

### 1. はじめに

**動機・背景**:
- フィッシング被害の深刻化（年間86.9億円、2024年報告件数171.8万件）
- SSL/TLS普及（HTTPS 83%以上）により従来手法の限界
- CSS2025で2段階ハイブリッドを提案、FNR 6.58%→1.04%を達成

**CSS2025の残課題**（本論文の出発点）:
- (1) Stage2フィルタがなく、全handoff候補にLLM処理 → 計算コスト課題
- (2) AI Agentの判定がLLM単体に依存 → 一貫性・再現性の課題
- (3) 偽陰性の原因分析が記述的で体系性に欠ける
- (4) 「高確信度で間違える」ケース（ML高スコアFP）への対策なし

**本論文の貢献**:
1. **Stage2（Gate/ルール層）の新設**: 証明書ルールにより74%のhandoff候補をフィルタし、LLM処理を9.4%に圧縮
2. **ルールエンジンの統合**: 35種のポリシールールにより、LLM判定を補完・修正する仕組みを実現
3. **偽陰性の体系的分析**: MLスコア領域別・検知パターン別の定量分析により、各Stageの役割と限界を明示
4. **説明可能な判定**: 各判定に対し平均6.5個のリスク要因とルール発火トレースを付与

**論文構成の案内**:
第2章で関連研究、第3章で提案手法、第4章で評価実験、第5章で議論、第6章でまとめ

---

### 2. 関連研究

**2.1 機械学習によるフィッシング検出**
- URL/ドメイン特徴量によるML検出の発展（Sahingoz [3], Alshingiti [5]）
- 証明書特徴量の活用（"Unmasking phishers" [10], "An effective detection" [12]）
- XGBoostの有効性（[4], [15]）
- 共通課題: ブラックボックス性、偽陰性の原因分析不足

**2.2 LLMによるフィッシング検出**
- 大型LLM: GPT-4V (Koide [2]), Fine-tuning (Liu [6])
- 小型LLM: Qwen-2.5-1.5B [Improving Small LLMs], 21モデルベンチマーク [MDPI]
- 共通課題: 計算コスト、全件LLM処理の非効率性

**2.3 マルチエージェント型検出**（★新規追加セクション）
- PhishDebate: 4専門エージェント + Debate → F1 94.14%
- MultiPhishGuard: メタデータ・本文・URL並列分析
- 共通特徴: GPT-4レベルの大型LLM前提、全件LLM処理

**2.4 ハイブリッド手法**
- ML+LLMの組み合わせ（[1], [13], [14]）
- CSS2025の2段階設計（本研究の前段）
- トリアージ（ML絞り込み→LLM精査）の効率性

**2.5 説明可能AI（XAI）によるフィッシング検出**（★新規追加セクション）
- EXPLICATE: ML検出 + SHAP/LIME + LLM変換
- 規制要求（GDPR等）による説明可能性の重要性増大
- 本研究のルールエンジンによる説明可能性との関連

**2.6 本研究の位置づけ**
- 新規性マトリクス（表）
  - 3段カスケード（他研究にない設計）
  - 小型LLM（4B量子化、ローカルGPU完結）
  - 証明書のみ（ページ取得不要→早期検知可能）
  - ルールエンジン統合（LLM + 明示的ドメイン知識）

---

### 3. 提案手法

**3.1 全体設計**
- 3段カスケードアーキテクチャ（図: CSS2025の図1を拡張）
  ```
  Stage1: XGBoost → 高速スクリーニング
  Stage2: Gate/Rule → 高確信度救済 + 効率化フィルタ
  Stage3: LLM + Rule Engine → 境界域精査
  ```
- CSS2025からの変更点を明示（2段→3段、ルールエンジン追加）
- 設計原則: 「容易なケースは高速に、困難なケースは精密に」

**3.2 Stage1: XGBoostによる高速スクリーニング**（CSS2025から継承）
- 31特徴量（ドメイン構造15個、TLS証明書5個、ブランド1個等）
  - ※CSS2025では21特徴量 → 31特徴量に拡張した点を記述
- 確信度に基づく振り分け（auto_phishing / auto_benign / handoff）
- Feature Importance分析（図）

**3.3 Stage2: Gate/ルールベースフィルタリング**（★新規セクション）
- **設計動機**: CSS2025の課題「高確信度誤判定」への対応
- ルールカテゴリと件数:
  - Cert Gate (B1-B4): OV/EV証明書→benign保護
  - Low Signal Gate (P1-P4): 低シグナルPhishing検出
  - ML Guard: ML高スコア時の強制判定
- フィルタ効果: 60,974件 → 15,670件（74%圧縮）

**3.4 Stage3: AI Agent + ルールエンジン**
- **3.4.1 AI Agentの構成**（CSS2025から拡張）
  - LangGraph + Qwen3-4B (FP8量子化)
  - 4種分析ツール（ブランド偽装、証明書解析、コンテキストリスク、短ドメイン）
  - Structured Output（is_phishing, confidence, risk_factors, reasoning）
- **3.4.2 ルールエンジン（★新規）**
  - 35種ポリシールール（6カテゴリ）
  - RuleContext → DetectionRule → RuleResult のパイプライン
  - ルールの実行順序とフェーズ管理
  - 代表的ルールの説明:
    - Policy R1-R6: コンテキストスコアベース判定
    - CTX Trigger: 高ctxスコア時の強制判定
    - Brand+Cert: ブランド偽装×証明書品質の複合判定
  - モジュール化設計: 個別ルールの有効/無効化、閾値調整が可能
- **3.4.3 判定統合フロー**
  - LLM判定 → ルールエンジン適用 → 最終判定
  - ルール発火トレースによる説明可能性確保

---

### 4. 評価実験

**4.1 実験設定**
- データセット: 127,754件（Phishing 63,877 / Benign 63,877）
- データソース: JPCERT/CC、PhishTank、Tranco
- XGBoost: 5-fold交差検証、ROC-AUC 0.9889
- LLM: Qwen3-4B (FP8), vLLM推論サーバ
- 評価環境: 3GPU並列（ローカル1 + リモート2）

**4.2 Stage1: XGBoostの性能**
- 精度95.70%、FNR 5.11%（stage1_decision基準）
- 特徴量重要度分析（図: Feature Importance）
- handoff候補の分布: 60,974件（phishing 3,257 / benign 57,717）

**4.3 Stage2: Gate/ルールの効果**（★新規）
- フィルタ結果: 45,304件をbenign確定（うちFN 518件）
- Stage3入力の圧縮: 60,974件 → 15,670件
- 計算コスト削減効果（LLM処理 74%削減）

**4.4 Stage3: AI Agent + ルールエンジンの性能**
- **4.4.1 Stage3単体性能**（handoff候補11,952件）
  - 混同行列（表）
  - F1 72.31%, Precision 76.01%, Recall 68.96%
- **4.4.2 ルールエンジンの発火分析**（★新規）
  - ルール発火ランキング（表: policy_r4: 142件, policy_r2: 100件 ...）
  - リスク要因ランキング（表）
  - 検知パターン分類:
    - DV/Free CA証明書問題（295件）
    - 危険TLD検出（223件）
    - ML Paradox（98件）
    - ブランド偽装+低品質証明書（78件）
- **4.4.3 Stage3のみが検知できたPhishing: 327件**（★新規の深い分析）
  - MLスコア分布: ML<0.3が54%（Stage1では原理的に検知不能）
  - 代表事例（表）
  - ルールエンジンの条件付き推論の有効性

**4.5 システム全体の性能**（★大幅拡充）
- **4.5.1 3段階システム全体**
  - F1 98.66%, Precision 99.15%, Recall 98.18%
  - 処理フロー全体像（図: 各Stageの処理件数とTP/FP/FN/TN）
- **4.5.2 Stage1+2のみ vs Stage1+2+3**（★新規比較）
  - Stage1+2: F1 97.71%
  - Stage1+2+3: F1 98.66%（+0.95pp）
  - Stage3の貢献: FN 1,686件削減、FP 532件増加（FN:FP = 1:0.32）
- **4.5.3 CSS2025からの改善**
  - Baseline（CSS2025相当）: F1 97.98% → 現在: F1 98.66%（+0.68pp）
  - FP: 1,150件 → 534件（-53.7%）
  - FN: 1,425件 → 1,160件（-18.6%）
- **4.5.4 関連研究との比較**（表）
  - 本研究 vs PhishDebate vs 21 LLMs Benchmark 等
  - ※データセットの違いに注意点を記載

---

### 5. 議論

**5.1 各Stageの役割と相補性**
- Stage1: 高速・高精度だが境界域に弱い（52%を処理）
- Stage2: 効率化 + 「高確信度誤判定」救済（38%を処理）
- Stage3: 条件付き推論で境界域を精査（9.4%を処理）
- 3段設計によるコスト効率（全件LLM処理との対比）

**5.2 ルールエンジンの意義**（★新規）
- **ML検出の限界を補完する条件付き推論**:
  - ML < 0.1 でもPhishing検知: 62件
  - 「DV証明書 + 危険TLD + ブランド偽装」の複合条件
  - XGBoostのツリー構造では捉えにくい非線形な組み合わせ
- **説明可能性**: ルール名 + 発火理由 + リスク要因で判定根拠を提示
- **俊敏性**: ルール単位の追加・調整でML再学習なしに対応可能
- **再現性**: LLM単体判定と異なり、同一条件で同一結果を保証

**5.3 FP/FNトレードオフの合理性**
- FN:FP = 1:0.32（1件の見逃し防止に0.32件の誤検知）
- フィッシング被害コスト >> 誤検知確認コスト
- brand_cert_high ML閾値（0.12）によるFP最適化の実例

**5.4 証明書ベース早期検知の優位性**
- ページ取得不要 → ダウン済みサイトにも適用可能
- CT Log監視によるサイト稼働前検知
- 従来研究（URL+HTML+スクリーンショット前提）との差異

**5.5 制約事項**
- 計算資源（GPU VRAM 24GB以上推奨）
- 処理時間（平均8.31秒/ドメイン）
- 言語依存性（ブランドキーワード辞書の多言語対応が課題）
- Stage2 FN（518件のPhishingをbenign判定）

**5.6 今後の課題**
- (1) Stage2フィルタのFN削減（518件→目標300件以下）
- (2) 時系列評価（ゼロデイ検出能力の検証）
- (3) 説明可能性の深化（反事実的説明の統合）
- (4) 適応的特徴量学習（ルールエンジンの知見をML再学習に反映）

---

### 6. まとめ

- CSS2025の2段階システムを3段階に拡張
- Stage2ルール層の新設によりLLM処理を74%削減しつつ精度維持
- 35種ポリシールールの統合により:
  - F1 98.66%（CSS2025相当のBaseline 97.98%から+0.68pp）
  - FP 53.7%削減（1,150件→534件）
  - Stage3のみが検知可能なPhishing 327件を確認
- 偽陰性の体系的分析により、MLの構造的限界とAI Agent/ルールエンジンの相補的効果を定量的に示した

---

## 図表計画

### 図
| # | 内容 | 対応セクション |
|---|------|-------------|
| 図1 | 3段カスケードアーキテクチャ（CSS2025の図1を拡張） | 3.1 |
| 図2 | XGBoost学習曲線 | 4.2 |
| 図3 | 特徴量重要度（Feature Importance Top 15） | 4.2 |
| 図4 | 偽陰性のMLスコア分布 | 4.4.3 |
| 図5 | AI Agentの解析フロー（事例） | 3.4 or 4.4 |
| 図6 | 処理フロー全体像（各Stageの件数遷移）★新規 | 4.5.1 |
| 図7 | Stage3検知パターンの分類（Venn図 or 棒グラフ）★新規 | 4.4.2 |

### 表
| # | 内容 | 対応セクション |
|---|------|-------------|
| 表1 | XGBoostの性能指標 | 4.2 |
| 表2 | MLスコア領域別の偽陰性分布 | 4.2 |
| 表3 | Stage2フィルタ結果★新規 | 4.3 |
| 表4 | Stage3混同行列 | 4.4.1 |
| 表5 | ルール発火ランキング★新規 | 4.4.2 |
| 表6 | Stage3固有検知の検知パターン★新規 | 4.4.3 |
| 表7 | システム全体性能（Stage1+2 vs Stage1+2+3）★新規 | 4.5.2 |
| 表8 | CSS2025 Baselineからの改善★新規 | 4.5.3 |
| 表9 | 関連研究との性能比較 | 4.5.4 |
| 表10 | 新規性マトリクス | 2.6 |

---

## CSS2025からの再利用・拡張

### 再利用可能（加筆修正）
- 1章の背景（フィッシング被害統計）→ 最新データに更新
- 3.2 XGBoost特徴量設計 → 31特徴量に拡張を反映
- 4.1 実験設定 → データセットの変更を反映
- 4.2 Stage1評価 → 基本構造は同じ

### 新規執筆が必要
- **3.3 Stage2全体**（CSS2025に存在しない）
- **3.4.2 ルールエンジン**（CSS2025に存在しない）
- **4.3 Stage2評価**（CSS2025に存在しない）
- **4.4.2 ルール発火分析**（CSS2025に存在しない）
- **4.5 システム全体性能の多角的比較**（CSS2025は2段のみ）
- **5.2 ルールエンジンの意義**（CSS2025に存在しない）

---

## 想定ページ数

CSSフォーマット（2段組、8ページ）を想定:

| セクション | ページ数 |
|----------|---------|
| 1. はじめに | 1.0 |
| 2. 関連研究 | 1.5 |
| 3. 提案手法 | 2.0 |
| 4. 評価実験 | 2.5 |
| 5. 議論 | 0.5 |
| 6. まとめ | 0.3 |
| 参考文献 | 0.2 |
| **合計** | **8.0** |

※ ページ数が厳しい場合の削減候補:
- 2.5 XAIセクション → 2.4に統合
- 4.5.4 関連研究比較 → 議論に移動
- 5.4 早期検知 → 簡略化

---

## 執筆順序（推奨）

1. **4章（評価実験）**: データが揃っているため最初に書ける。図表を先に作成。
2. **3章（提案手法）**: 評価で使った手法を説明する形で記述。
3. **5章（議論）**: 評価結果を踏まえた考察。
4. **2章（関連研究）**: related_work.md をベースに構成。
5. **1章（はじめに）**: 全体を書いた後に統一的に記述。
6. **6章（まとめ）**: 最後に執筆。

---

## 論文の核心メッセージ

> CSS2025で提案した2段階ハイブリッドシステムに対し、Stage2（ルールベースフィルタ）の新設とStage3へのルールエンジン統合を行った。この拡張により、LLM処理量を74%削減しながら、システム全体のF1を97.98%から98.66%に向上させた。特に、MLスコアが極めて低い（< 0.3）にもかかわらずフィッシングである327件を、ルールエンジンの条件付き推論（証明書品質 × TLD × ブランド偽装の複合判定）により検知できることを示した。これは、統計的パターンに依存するML単体では原理的に検知困難な領域であり、明示的なドメイン知識のルール化がML方式の構造的限界を補完することを定量的に実証した。
