# 研究日誌 2026-02-06

## 本日の作業内容

1. 論文骨子（paper outline）の作成
2. TLS証明書ベース研究のサーベイ（§13追加）
3. 関連研究メモの引用監査
4. 監査結果に基づくCritical/Major/Minor修正の適用
5. 全件評価（127,754件）の完了確認

---

## 1. 論文骨子の作成

### 1.1 概要

CSS2025（前回論文: 2段階システム）の構造を参考に、新論文の骨子を作成。

**出力ファイル**: `docs/paper/paper_outline.md`

### 1.2 CSS2025 → 新論文の進化マトリクス

| 観点 | CSS2025 | 新論文 |
|------|---------|--------|
| アーキテクチャ | 2段階 (XGBoost→AI Agent) | **3段カスケード (XGBoost→Gate/Rule→AI Agent)** |
| データ規模 | 640,356件 | **127,754件（証明書取得済み）** |
| FNR | 6.58%→1.04% | **1.82%（Stage1+2+3）** |
| ルールエンジン | なし | **35ルール、6カテゴリ** |
| LLM | GPT-4等（クラウド） | **Qwen3-4B（ローカル量子化）** |

### 1.3 論文構成（6章構成、8ページ）

| 章 | タイトル | ページ |
|----|---------|--------|
| 1 | Introduction | 1.0 |
| 2 | Related Work | 1.0 |
| 3 | Proposed Method | 2.5 |
| 4 | Evaluation | 2.0 |
| 5 | Discussion | 1.0 |
| 6 | Conclusion | 0.5 |

### 1.4 コアメッセージ

> 「MLの構造的限界を明示的なドメイン知識のルール化が補完する」

---

## 2. TLS証明書ベース研究サーベイ

### 2.1 調査範囲

本研究の中核である「TLS証明書を用いたフィッシング検出」に関する先行研究を網羅的に調査。

### 2.2 追加した文献（17件: R28-R44）

| カテゴリ | 件数 | 代表的な論文 |
|---------|------|-------------|
| CT Logベース検出 | 5件 | Phicious (RAID 2022), Phish-Hook (SecureComm 2019) |
| 証明書特徴量ML | 5件 | Haraldsdottir (C&IE 2024), Sakurai (EuroSPW 2020) |
| 早期検知/ライフサイクル | 4件 | DomainDynamics (CCNC 2025), Uninvited Guests (USENIX Sec 2022) |
| LLM+証明書 | 1件 | C-BERT (AISec/CCS 2024) |
| TLSトラフィック | 3件 | Kumar (Cluster Computing 2023) |
| CT検査の限界 | 1件 | INDIACom 2023 |

### 2.3 重要な発見

1. **証明書ベース検出は確立分野**: RAID, USENIX Security, NDSS, EuroS&P等のトップ会議で発表
2. **LLM+証明書の組み合わせは未開拓**: C-BERT（ボットネット対象）のみ → 本研究の新規性を支持
3. **日本の関連研究**: Sakurai et al. (森達哉教授グループ)、DomainDynamics (千葉ら, NTT)

### 2.4 出力

`docs/research/related_work.md` §13として追記（約230行）

---

## 3. 引用監査

### 3.1 監査方法

「研究不正・引用監査官」として、related_work.md の全44件の参考文献を以下の6ステップで検証:

1. URL存在確認・HTTPステータス確認
2. タイトル・著者・年・会場の原文照合
3. 数値主張の原論文との照合
4. 関連研究との比較の公正性チェック
5. 新規性主張の根拠チェック
6. 査読ステータスの正確性チェック

### 3.2 検出結果

| 重大度 | 件数 | 内容 |
|--------|------|------|
| **Critical** | 5件 | DOI誤り、会場名誤り、著者名誤り、出典不明数値、先制検知の誇張 |
| **Major** | 12件 | 比較不能な性能比較、新規性主張の根拠不足、査読なしの不明記 |
| **Minor** | ~15件 | タイトル不完全、年不一致、URL未記載 |

### 3.3 出力

`docs/research/related_work_audit_report.md`（約320行）

---

## 4. 監査修正の適用

### 4.1 Critical修正（5件）

| # | 対象 | 修正内容 |
|---|------|---------|
| C-1 | R20 PhishIntel | DOI `10.5555/...` → `10.1145/3701716.3715192` に修正 |
| C-2 | R30 Phish-Hook | 会場名 NordSec 2019 → SecureComm 2019 に修正、著者追加 |
| C-3 | R41 C-BERT | 著者 Arkhangorodsky → Shashwat, Hahn, Millar, Ou に修正 |
| C-4 | §6.3 | Precision 66.7%→14.8% に [要出典確認] 追記 |
| C-5 | §10.3 | 先制検知の誇張を修正（事後分類であることを明記） |

### 4.2 Major修正（12件）

| # | 対象 | 修正内容 |
|---|------|---------|
| D-1 | §2.2 R05 | 「ACM CCS 2025投稿」を削除 |
| D-2 | §3.3 R09 | F1=82.6%に「21モデル平均」「最高 91.24%」を追記 |
| D-3 | §3.5 R11 | タイトルを「Zero-shot and Few-shot」に修正 |
| D-4 | §4.3 R14 | XGBoost 99.65% に [要確認] 付記 |
| D-5 | §5.1 R15 | F1 100%に「標準評価上」「ネットワーク侵入検知」注記 |
| D-6 | §5.2 R16 | 出版年を「eHaCON 2025, Springer, published 2026」に修正 |
| D-7 | §9.1 R26 | SSRNに「査読なし」を明記 |
| D-8 | §13.1.5 R32 | Preprints.orgに「査読なし」を明記 |
| D-9 | §4.4/§5.3 | 引用文2箇所に [出典要特定] を追記 |
| D-10 | §11.2 | 「公平な比較」→「性能比較（参考値）」に変更、注記追加 |
| D-11 | §10.2 | 「先行研究に見られない」→「我々の調査範囲では」に弱化 |
| D-12 | §13.7 | 「本研究が先駆的」→「確認されなかった」に弱化 |

### 4.3 Minor修正（7件）

| # | 対象 | 修正内容 |
|---|------|---------|
| F-15 | §3.5 R11 | 内容説明にフューショットを追記 |
| F-16 | R16 参考文献 | 出版年修正 |
| F-17 | R21 PhishAgent | DOI `10.1609/aaai.v39i27.35003` を追記 |
| F-18 | §13.2.3 R34 | EuroSPW版タイトルを明記 |
| F-19 | §13.3.3 R39 | NSA賞の年を「第11回 2023年ノミネート/2024年授与」に正確化 |
| F-20 | §13.6.1 R44 | 「IEEE 2023」→「INDIACom 2023 (IEEE)」に正確化 |
| - | R30/R40 参考文献 | 著者名・会場名を本文修正と整合 |

### 4.4 残存する要確認タグ（4件）

論文執筆時にフルテキスト確認が必要:

| 箇所 | 内容 |
|------|------|
| §4.3 L148 | R14 XGBoost 99.65% vs 99.17% |
| §4.4 L162 | 引用文 "Regulatory frameworks..." の出典特定 |
| §5.3 L194 | 引用文 "LLMs currently underperform..." の出典特定 |
| §6.3 L227-234 | Precision 66.7%→14.8% の出典特定 |

---

## 5. 全件評価（127,754件）の完了確認

### 5.1 評価概要

| 項目 | 値 |
|------|-----|
| 評価ID | eval_20260205_230157 |
| 開始 | 2026-02-05 23:01 |
| 完了 | 2026-02-06 11:30 |
| 処理件数 | 2,738/2,741（Worker 2完了） |
| タイムアウト | 3件（publisher-releases.com, mathgoeasy.com, orthodoxia.info） |

### 5.2 今回の評価の目的

Task #31（brand_cert_high ルールの ML閾値最適化: 0.12）の効果を全件で検証。

---

## 6. 変更ファイル一覧

| ファイル | 変更種別 | 内容 |
|---------|---------|------|
| `docs/paper/paper_outline.md` | 新規 | 論文骨子（6章構成、8ページ） |
| `docs/research/related_work.md` | 修正 | §13追加（17文献）+ 監査修正（Critical 5件 + Major 12件 + Minor 7件） |
| `docs/research/related_work_audit_report.md` | 新規 | 引用監査報告書（320行） |
| `docs/research/20260206.md` | 新規 | 本ドキュメント |

---

## 7. 本日の結論

### 完了タスク

| タスク | 状態 | 内容 |
|--------|------|------|
| 論文骨子作成 | ✅ 完了 | CSS2025構造ベースの6章構成 |
| 証明書サーベイ | ✅ 完了 | 17件追加（R28-R44） |
| 引用監査 | ✅ 完了 | 44件全URL確認、報告書作成 |
| 監査修正適用 | ✅ 完了 | Critical 5 + Major 12 + Minor 7 = 24件修正 |
| paper_outline改訂 | ✅ 完了 | ルール記述抑制 + Stage2 LR修正 |
| dataset_overview改訂 | ✅ 完了 | DB実測値に基づく全面改訂（証明書全件分析含む） |
| certificate_analysis改訂 | ✅ 完了 | DB全件実測（364K+450K）に基づく全面改訂 |

### 残タスク

| タスク | 状態 | 次のアクション |
|--------|------|----------------|
| [要確認] タグ4件 | 📋 保留 | 論文執筆時にフルテキスト確認 |
| 全件評価結果分析 | 🔄 次回 | eval_20260205_230157 の結果集計・分析 |
| 論文執筆開始 | 📋 次回 | paper_outline.md に基づき執筆開始 |

---

## 6. dataset_overview.md の全面改訂

### 6.1 背景

既存の `docs/research/dataset_overview.md` の数値がデータベースの実態と乖離していることが判明。PostgreSQL `rapids_data` に直接クエリを実行し、全数値を実測値に置き換えた。

### 6.2 発見された主な誤り

| 項目 | 旧文書の値 | DB実測値 | 乖離 |
|------|----------|---------|------|
| 正規証明書 平均有効期間 | 231.8日 | **153.2日** | -78.6日 |
| 正規証明書 90日証明書率 | 49.0% | **77.5%** | +28.5pp |
| 正規証明書 1年以上率 | 34.5% | **15.3%** | -19.2pp |
| certificates レコード数 | 532,426 | 532,117 | -309 |
| jpcert レコード数 | 224,032 | 222,984 | -1,048 |
| phishtank レコード数 | 95,857 | 94,295 | -1,562 |
| trusted レコード数 | 554,912 | 554,801 | -111 |

### 6.3 証明書有効期間分析（全件実査）

サンプリングではなく全件で実施。

**フィッシングサイト証明書:**

| ソース | N | 平均 | 中央値 | 90日証明書率 | LE率 |
|--------|---|------|--------|------------|------|
| certificates | 196,083 | 92.0日 | 89日 | 98.9% | 97.5% |
| jpcert | 115,617 | 100.2日 | 89日 | 96.0% | 91.3% |
| phishtank | 52,806 | 154.3日 | 89日 | 71.9% | 30.7% |

**正規サイト証明書:**

| ソース | N | 平均 | 中央値 | 90日証明書率 | LE率 |
|--------|---|------|--------|------------|------|
| trusted | 450,545 | 153.2日 | 90日 | 77.5% | 39.3% |

**重要な発見**: PhishTankのフィッシング証明書は正規サイトと類似の分布を示す（LE率30.7% vs 正規39.3%）。certificates/jpcert（日本中心）とPhishTank（国際）で特性が大きく異なる。

### 6.4 新規追加セクション

- Train/Test分割の詳細（511,012 / 127,754、80:20）
- ソース別内訳（certificates/jpcert/phishtank/trusted）
- 42個の特徴量一覧（ドメイン構造15個 + 証明書27個）
- ドメイン重複分析（ソース間INTERSECT結果）
- phishing_sitesテーブルの全カラムJSONB構造の明記

### 6.5 出力

`docs/research/dataset_overview.md` 全面改訂（404行 → 663行）

---

## 7. paper_outline.md の改訂

### 7.1 Stage2ルール記述の抑制

「ラベルを知ってるからルールを作れるんだろう」という批判を回避するため:
- 「35種ポリシールール」→「証明書ドメイン知識」に変更
- 具体的ルール名（B1-B4, P1-P4, R1-R6）を削除
- Threats to Validity セクションを追加

### 7.2 Stage2のLR記述修正

Stage2がルールのみという誤った記述を修正:
- Stage2の主機構: **ロジスティック回帰**（p_error予測、5-fold CV + OOF）
- 証明書属性ゲートは補助機構
- コアメッセージを「メタ学習(LR) + ドメイン知識(ルール)」に修正

---

## 8. certificate_analysis.md の全面改訂

### 8.1 背景

`docs/analysis/03_certificate_analysis.md` の旧版は20,000〜50,000件のサンプルに基づく分析だった。DB全件（フィッシング364,511件、正規450,545件）で再分析し、全数値を実測値に置き換えた。

### 8.2 主要な数値変更

| 項目 | 旧値（サンプル） | 新値（全件） | 変更理由 |
|------|----------------|-------------|---------|
| フィッシング DV率 | 99.9% | 98.6% | PhishTank含む全件 |
| フィッシング LE率 | 97.7% | 86.3% | PhishTank含む全件 |
| 正規 平均有効期間 | 168.5日 | **153.2日** | 全件分析 |
| 正規 90日以下 | 72.1% | **77.6%** | 全件分析 |
| 正規 1-2年 | 19.7% | **15.3%** | 全件分析 |
| フィッシング SAN 21-100 | 63.7% | 42.8% | 全件分析 |
| 正規 ワイルドカード | 55.1% | 46.1% | 全件分析 |
| 正規 CRL DP | 81.7% | **91.8%** | 全件分析 |
| 週末率差 | 7.6pp | **2.3pp** | 全件分析で差異縮小 |

### 8.3 新たな知見

- **§1.3 データソースの注意**: フィッシング3ソース（certificates/jpcert/phishtank）の特性差異を明記
- **§3.1 LE率のソース別差異**: 日本向け91-97% vs 国際31%
- **§4 有効期間のソース別差異**: PhishTankは正規サイトに近い分布
- **§6 OCSP逆転現象**: 正規72.9% < フィッシング96.6%（LE中心のため）
- **§7 週末発行差の縮小**: 旧版7.6pp→全件2.3ppに縮小
- **付録A**: 旧版からの全変更点を一覧表で明示

### 8.4 出力

`docs/analysis/03_certificate_analysis.md` 全面改訂（314行 → 366行）

---

## 9. 変更ファイル一覧（更新）

| ファイル | 変更種別 | 内容 |
|---------|---------|------|
| `docs/paper/paper_outline.md` | 新規→修正 | 論文骨子（ルール抑制 + LR修正） |
| `docs/research/related_work.md` | 修正 | §13追加 + 監査修正24件 |
| `docs/research/related_work_audit_report.md` | 新規 | 引用監査報告書 |
| `docs/research/dataset_overview.md` | **全面改訂** | DB実測値に基づく全面改訂 |
| `docs/analysis/03_certificate_analysis.md` | **全面改訂** | DB全件実測値に基づく改訂 |
| `docs/research/20260206.md` | 新規 | 本ドキュメント |

---

## 10. 所感

- 引用監査で5件のCritical問題（DOI誤り、会場名誤り、著者名誤り等）が発見された。これらがそのまま論文に転載されていれば、査読で致命的な指摘を受けていた可能性が高い。**関連研究を論文に使用する前に、必ず原論文との照合を行う**ことの重要性を再認識した。
- 「公平な比較」「先行研究に見られない」等の強い主張は、根拠なしに使用すると査読者の信頼を損なう。**主張の強さを裏付けの強さに比例させる**ことが重要。
- TLS証明書ベースの研究サーベイにより、本研究の位置づけがより明確になった。特に「LLM+証明書」の組み合わせが未開拓であることが確認でき、新規性の主張に（適切なヘッジ付きで）自信を持てる。
- dataset_overview.mdの数値がDB実態と乖離していた。特に正規証明書の平均有効期間（旧231.8日→実153.2日）は大幅な誤りだった。**ドキュメントの数値は必ずDBから直接クエリした実測値を使用し、推定値や記憶に頼らない**ことを徹底すべき。
- PhishTankのフィッシング証明書は、certificates/jpcert（日本中心）と異なりLet's Encrypt率が30.7%と低い。データソースの地域的偏りが証明書特性に大きく影響することを示しており、論文でもこの点に言及する必要がある。
