# SSL/TLS証明書特徴量に基づくフィッシングサイト検出のためのデータセット分析報告書

## 概要

本報告書は、フィッシングサイトと正規サイトのSSL/TLS証明書特徴量の差異を定量的に分析した結果をまとめたものである。分析により、証明書の認証レベル、発行者、有効期間、SAN構造、チェーン特性、および時間的パターンにおいて、両者の間に統計的に有意な差異が存在することを確認した。

---

## 1. データセット構成

### 1.1 データソース

| テーブル名 | 件数 | 証明書取得成功 | ソース |
|-----------|------|---------------|--------|
| certificates | 532,426 | 196,392 (36.9%) | JPCERT/CC フィッシングURL |
| jpcert_phishing_urls | 224,032 | 116,647 (52.1%) | JPCERT/CC フィード |
| phishtank_entries | 95,857 | 54,365 (56.7%) | PhishTank |
| trusted_certificates | 554,912 | 450,656 (81.2%) | Tranco Top Sites |

### 1.2 分析対象

- **フィッシングサイト**: 320,409ユニークドメイン（証明書取得成功分）
- **正規サイト**: 450,656ドメイン（Tranco由来）
- **分析サンプルサイズ**: 各カテゴリ20,000〜50,000件

---

## 2. 証明書認証レベル分析

### 2.1 DV/OV/EV分布

SSL/TLS証明書は認証レベルによりDomain Validation (DV)、Organization Validation (OV)、Extended Validation (EV)に分類される。

| 認証レベル | 正規サイト | フィッシング | 差分 |
|-----------|-----------|-------------|------|
| DV | 93.4% | 99.9% | +6.5% |
| OV | 6.0% | 0.1% | -5.9% |
| EV | 0.7% | 0.0% | -0.7% |

**考察**: フィッシングサイトはほぼ全て（99.9%）がDV証明書を使用している。OV/EV証明書は組織の実在確認が必要なため、フィッシング攻撃者にとって取得が困難である。

### 2.2 Subject Organization情報

証明書のSubjectフィールドにOrganization（組織名）が含まれる割合を分析した。

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| Organization情報あり | 6.6% | 0.1% |
| Country情報あり | 6.6% | 0.2% |

**識別力**: Organization情報の有無は、フィッシング検出において**高い識別力**を持つ特徴量である。

---

## 3. 証明書発行者分析

### 3.1 発行者（Certificate Authority）分布

| 発行者 | 正規サイト | フィッシング |
|--------|-----------|-------------|
| Let's Encrypt | 39.8% | **97.7%** |
| Google Trust Services | 35.1% | 0.5% |
| DigiCert | 4.6% | 0.4% |
| Sectigo | 4.3% | 0.3% |
| Amazon | 4.3% | - |
| GoDaddy | 3.1% | 0.2% |

**考察**: フィッシングサイトの97.7%がLet's Encrypt証明書を使用している。Let's Encryptは無料かつ自動化された証明書発行が可能なため、攻撃者に悪用されやすい。一方、正規サイトはGoogle Trust Services（35.1%）やその他の有料CAも多く利用している。

### 3.2 Let's Encrypt Intermediate CA世代分布

| Intermediate CA | 正規サイト | フィッシング |
|-----------------|-----------|-------------|
| R3（旧世代・2024年期限切れ） | 0.0% | **85.9%** |
| R10/R11（現行世代） | 22.5% | 11.0% |
| E5/E6（ECDSA） | 9.3% | 0.4% |
| WE1（Google） | 34.5% | 0.4% |

**考察**: フィッシング証明書の85.9%が旧世代のR3 Intermediateから発行されている。これはフィッシングデータの多くが2021-2024年に収集されたことを反映している。

---

## 4. 証明書有効期間分析

### 4.1 有効期間分布

| 有効期間 | 正規サイト | フィッシング |
|----------|-----------|-------------|
| 90日以下 | 72.1% | **98.9%** |
| 91-180日 | 0.7% | 0.0% |
| 181-365日 | 7.3% | 1.0% |
| 1-2年 | **19.7%** | 0.1% |

### 4.2 統計量

| 統計量 | 正規サイト | フィッシング |
|--------|-----------|-------------|
| 平均有効期間 | 168.5日 | 92.0日 |
| 中央値 | 90日 | 89日 |

**考察**: フィッシングサイトは98.9%が90日以下の短期証明書を使用している。これはLet's Encryptの証明書有効期間（90日）と一致する。正規サイトは19.7%が1-2年の長期証明書を使用しており、有料CAからの発行が含まれる。

---

## 5. Subject Alternative Names (SAN) 分析

### 5.1 SAN数分布

| SAN数 | 正規サイト | フィッシング |
|-------|-----------|-------------|
| 1 | 21.3% | 18.0% |
| 2-5 | **68.0%** | 8.2% |
| 6-20 | 5.7% | 10.0% |
| 21-100 | 4.3% | **63.7%** |
| 100+ | 0.7% | 0.0% |

**考察**: フィッシング証明書の63.7%が21-100個のSANを含んでいる。これは動的DNSサービス（特にDuckDNS）を利用した大量ドメイン運用パターンを示している。

### 5.2 ワイルドカード証明書

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| ワイルドカード使用率 | **55.1%** | 1.5% |

**考察**: 正規サイトの半数以上がワイルドカード証明書（`*.example.com`形式）を使用しているのに対し、フィッシングサイトではほとんど使用されていない。これは高い識別力を持つ特徴量である。

### 5.3 SAN多様性指標

SAN多様性指標 = ユニークSLD数 / 総SAN数

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| SAN多様性指標（平均） | 0.472 | 0.288 |

**考察**: フィッシング証明書は同一のセカンドレベルドメイン（例: `duckdns.org`）配下に多数のサブドメインを登録するパターンが多く、多様性指標が低い。

---

## 6. 証明書チェーン特性分析

### 6.1 チェーン関連拡張の保有率

| 拡張 | 正規サイト | フィッシング | 差分 |
|------|-----------|-------------|------|
| Authority Key Identifier | 100.0% | 100.0% | 0.0% |
| Subject Key Identifier | 99.8% | 99.8% | 0.0% |
| Authority Info Access | 100.0% | 100.0% | 0.0% |
| OCSP Responder URL | 100.0% | 99.9% | +0.1% |
| CA Issuers URL | 100.0% | 100.0% | 0.0% |
| **CRL Distribution Points** | **81.7%** | **1.6%** | **+80.1%** |
| Certificate Transparency SCT | 100.0% | 98.8% | +1.2% |

**重要な発見**: CRL Distribution Points（証明書失効リスト配布点）の保有率に80.1%の差異がある。Let's Encrypt証明書はCRLではなくOCSPを使用するため、この差異が生じている。

---

## 7. 時間的パターン分析

### 7.1 発行曜日分布

| 曜日 | 正規サイト | フィッシング |
|------|-----------|-------------|
| 月曜 | 15.5% | 14.3% |
| 火曜 | 15.6% | 13.4% |
| 水曜 | 16.4% | 14.0% |
| 木曜 | 16.2% | 15.0% |
| 金曜 | 14.9% | 14.2% |
| **土曜** | 10.9% | **13.9%** |
| **日曜** | 10.5% | **15.1%** |

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| 週末発行率 | 21.4% | **29.0%** |

**考察**: フィッシング証明書は週末（特に日曜日）に発行される割合が高い。これは監視体制が手薄になる週末を狙った攻撃パターンを示唆している。

### 7.2 発行時刻分布（UTC）

| 時間帯 | 正規サイト | フィッシング | 解釈 |
|--------|-----------|-------------|------|
| 深夜 (0-5時) | **38.6%** | 18.2% | 自動更新システム |
| 午前 (6-11時) | 21.8% | **43.3%** | アジア時間帯の手動発行 |
| 午後 (12-17時) | 20.9% | 28.3% | - |
| 夜間 (18-23時) | 18.7% | 10.2% | - |

**考察**:
- 正規サイトは00時UTC（深夜）にピーク（23.6%）があり、自動更新システムによる定期更新パターンを示す
- フィッシングサイトは06-07時UTC（アジア地域の午後）にピーク（25.6%）があり、手動による証明書発行を示唆

---

## 8. TLD（トップレベルドメイン）分析

### 8.1 危険TLDランキング

フィッシング率 = フィッシングドメイン数 / (フィッシング + 正規ドメイン数)

| 順位 | TLD | フィッシング率 | サンプル数 |
|------|-----|---------------|-----------|
| 1 | .gq | 100.0% | 286 |
| 2 | .ga | 99.8% | 451 |
| 3 | .ci | 98.9% | 2,023 |
| 4 | .cfd | 98.7% | 4,489 |
| 5 | .mw | 98.4% | 947 |
| 6 | .tk | 98.2% | 392 |
| 7 | .icu | 97.8% | 5,162 |
| 8 | .cn | 97.4% | 60,701 |
| 9 | .bar | 97.4% | 611 |
| 10 | .cyou | 96.7% | 1,134 |

### 8.2 安全TLD

| TLD | フィッシング率 | サンプル数 |
|-----|---------------|-----------|
| .gov | 0.0% | 1,592 |
| .edu | 0.04% | 2,664 |
| .nl | 0.6% | 7,538 |
| .uk | 0.8% | 15,410 |

---

## 9. ドメイン構造分析

### 9.1 ドメイン構造統計

| 特徴 | 正規サイト | フィッシング | 差分 |
|------|-----------|-------------|------|
| ドメイン長（平均） | 15.0文字 | 20.3文字 | +5.3 |
| ドット数（平均） | 1.1 | 2.1 | +1.0 |
| サブドメイン深度（平均） | 0.1 | 1.1 | +1.0 |
| SLD長（平均） | 10.3文字 | 7.9文字 | -2.4 |
| 数字含有率 | 5.9% | 21.0% | +15.1% |

### 9.2 サブドメイン深度分布

| 深度 | 正規サイト | フィッシング |
|------|-----------|-------------|
| 0（サブドメインなし） | **90.5%** | 24.6% |
| 1 | 9.5% | **59.0%** |
| 2 | 0.0% | 5.2% |
| 3以上 | 0.0% | 11.0% |

**考察**: フィッシングサイトの75%以上がサブドメインを使用しており、正規サイト（9.5%）と大きく異なる。

---

## 10. 特徴量の識別力サマリー

分析結果に基づき、フィッシング検出に有効な特徴量を識別力順にまとめる。

### 10.1 高識別力特徴量（差分30%以上）

| 特徴量 | 正規 | フィッシング | 差分 | 識別力 |
|--------|------|-------------|------|--------|
| CRL Distribution Points保有 | 81.7% | 1.6% | 80.1% | 極めて高 |
| サブドメイン深度=0 | 90.5% | 24.6% | 65.9% | 極めて高 |
| SAN数 21-100 | 4.3% | 63.7% | 59.4% | 極めて高 |
| ワイルドカード証明書 | 55.1% | 1.5% | 53.6% | 極めて高 |
| Let's Encrypt使用 | 39.8% | 97.7% | 57.9% | 極めて高 |

### 10.2 中識別力特徴量（差分10-30%）

| 特徴量 | 正規 | フィッシング | 差分 | 識別力 |
|--------|------|-------------|------|--------|
| 90日以下の有効期間 | 72.1% | 98.9% | 26.8% | 高 |
| 1-2年の有効期間 | 19.7% | 0.1% | 19.6% | 高 |
| 数字を含むドメイン | 5.9% | 21.0% | 15.1% | 中 |

### 10.3 低識別力特徴量（差分10%未満）

| 特徴量 | 正規 | フィッシング | 差分 |
|--------|------|-------------|------|
| 週末発行 | 21.4% | 29.0% | 7.6% |
| OV/EV証明書 | 6.6% | 0.1% | 6.5% |
| Organization情報あり | 6.6% | 0.1% | 6.5% |

---

## 11. 結論

本分析により、以下の知見が得られた。

1. **証明書認証レベル**: フィッシングサイトは99.9%がDV証明書を使用し、OV/EV証明書はほぼ皆無である

2. **発行者パターン**: フィッシングサイトの97.7%がLet's Encrypt証明書を使用しており、無料CAへの依存が顕著である

3. **有効期間**: フィッシングサイトは98.9%が90日以下の短期証明書を使用している

4. **SAN構造**: フィッシングサイトは大量のSAN（21-100件）を持つ証明書を使用する傾向があり、動的DNSサービスの悪用パターンを示す

5. **ワイルドカード**: 正規サイトの55.1%がワイルドカード証明書を使用するのに対し、フィッシングは1.5%と極めて低い

6. **チェーン特性**: CRL Distribution Pointsの保有率に80.1%の差異があり、高い識別力を持つ

7. **時間的パターン**: フィッシング証明書は週末発行率が高く（29.0% vs 21.4%）、アジア時間帯（UTC 6-7時）に発行が集中する

8. **ドメイン構造**: フィッシングサイトの75%以上がサブドメインを使用し、ドメイン長も平均5文字長い

これらの特徴量を組み合わせることで、証明書情報のみに基づく高精度なフィッシング検出が可能であると考えられる。

---

## 付録: 分析環境

- データベース: PostgreSQL 16.11
- 証明書パース: Python cryptography library
- 分析期間: 2026年1月
- 証明書収集期間: 2025年3月〜2025年8月

---

**作成日**: 2026-01-12
**作成者**: 研究チーム
