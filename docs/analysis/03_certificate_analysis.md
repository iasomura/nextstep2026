# SSL/TLS証明書特徴量に基づくフィッシングサイト検出のためのデータセット分析報告書

> **最終更新**: 2026-02-06（DBから直接クエリした全件実測値に基づく改訂）

## 概要

本報告書は、フィッシングサイトと正規サイトのSSL/TLS証明書特徴量の差異を定量的に分析した結果をまとめたものである。分析により、証明書の認証レベル、発行者、有効期間、SAN構造、チェーン特性、および時間的パターンにおいて、両者の間に統計的に有意な差異が存在することを確認した。

---

## 1. データセット構成

### 1.1 データソース

| テーブル名 | 件数 | 証明書取得成功 | ソース |
|-----------|------|---------------|--------|
| certificates | 532,117 | 196,083 (36.9%) | JPCERT/CC フィッシングURL |
| jpcert_phishing_urls | 222,984 | 115,620 (51.9%) | JPCERT/CC フィード |
| phishtank_entries | 94,295 | 52,808 (56.0%) | PhishTank |
| trusted_certificates | 554,801 | 450,545 (81.2%) | Tranco Top Sites |

### 1.2 分析対象

- **フィッシングサイト**: 364,511件（3ソース統合、証明書取得成功分全件）
- **正規サイト**: 450,545ドメイン（Tranco由来、証明書取得成功分全件）
- **分析方法**: サンプリングではなく**全件分析**

### 1.3 分析上の注意

フィッシングデータの3ソースは特性が異なる:
- **certificates/jpcert**: 日本向けフィッシングが中心。Let's Encrypt比率が極めて高い（91-97%）
- **phishtank**: 国際的なフィッシング。Let's Encrypt比率が低く（31%）、Google/Amazon等が上位

以下の分析は3ソース統合値を報告する。ソースによる差異が顕著な項目は注記する。

---

## 2. 証明書認証レベル分析

### 2.1 DV/OV/EV分布

SSL/TLS証明書は認証レベルによりDomain Validation (DV)、Organization Validation (OV)、Extended Validation (EV)に分類される。

| 認証レベル | 正規サイト | フィッシング | 差分 |
|-----------|-----------|-------------|------|
| DV | 93.8% | 98.6% | +4.8% |
| OV | 5.5% | 0.6% | -4.9% |
| EV | 0.7% | 0.8% | +0.1% |

**考察**: フィッシングサイトの98.6%がDV証明書を使用している。OV/EV証明書は組織の実在確認が必要なため、フィッシング攻撃者にとって取得が困難である。なお、フィッシング側のEV 0.8%はPhishTank由来の大手サービス悪用ケースを含む。

### 2.2 Subject Organization情報

証明書のSubjectフィールドにOrganization（組織名）が含まれる割合を分析した。

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| Organization情報あり | 6.2% | 1.4% |
| Country情報あり | 6.2% | 1.4% |

**識別力**: Organization情報の有無はフィッシング検出において識別力を持つ特徴量である。ただしPhishTank由来データを含む場合、フィッシング側の保有率が若干上昇する（0.1%→1.4%）。

---

## 3. 証明書発行者分析

### 3.1 発行者（Certificate Authority）分布

| 発行者 | 正規サイト | フィッシング |
|--------|-----------|-------------|
| Let's Encrypt | 39.3% | **86.3%** |
| Google Trust Services | 36.8% | 5.9% |
| DigiCert | 4.5% | 1.9% |
| Amazon | 4.5% | 1.9% |
| Sectigo | 4.5% | 0.6% |
| GoDaddy | 2.5% | 0.5% |
| GlobalSign | 2.4% | - |
| ZeroSSL | 0.7% | 1.0% |
| CLOUDFLARE | - | 0.4% |
| cPanel | - | 0.5% |

**考察**: フィッシングサイトの86.3%がLet's Encrypt証明書を使用している。ただしこの比率はデータソースにより大きく異なる:
- certificates（日本向け）: **97.5%**
- jpcert（日本向け）: **91.3%**
- phishtank（国際）: **30.7%**

PhishTankではGoogle Trust Services（31.0%）やAmazon（12.6%）等の比率が高く、フィッシングの地域性・多様性を反映している。

### 3.2 Let's Encrypt Intermediate CA世代分布

| Intermediate CA | 正規サイト | フィッシング |
|-----------------|-----------|-------------|
| R3（旧世代・2024年期限切れ） | 0.0% | **69.3%** |
| R10/R11（現行世代） | 30.4% | 12.7% |
| E5/E6（ECDSA） | 8.8% | 2.8% |
| WE1（Google Trust Services） | 35.7% | 2.7% |
| Let's Encrypt Authority X3（旧世代） | 0.0% | 1.3% |

**考察**: フィッシング証明書の69.3%が旧世代のR3 Intermediateから発行されている。これはフィッシングデータの多くが2021-2024年に収集されたことを反映している。正規サイトは2025年に収集されたため現行世代（R10/R11/E5/E6）が中心。

---

## 4. 証明書有効期間分析

### 4.1 有効期間分布

| 有効期間 | 正規サイト | フィッシング |
|----------|-----------|-------------|
| 90日以下 | 77.6% | **94.7%** |
| 91-180日 | 0.5% | 0.1% |
| 181-365日 | 6.6% | 2.7% |
| 1-2年 | **15.3%** | 2.6% |

### 4.2 統計量

| 統計量 | 正規サイト | フィッシング |
|--------|-----------|-------------|
| 平均有効期間 | 153.2日 | 103.6日 |
| 中央値 | 90日 | 89日 |

**考察**: フィッシングサイトの94.7%が90日以下の短期証明書を使用している。正規サイトも77.6%が90日以下であるが、15.3%が1-2年の長期証明書を持つ点が異なる。

**データソース別の差異**:
- certificates: 平均92.0日、90日以下**98.9%**
- jpcert: 平均100.2日、90日以下96.0%
- phishtank: 平均154.3日、90日以下71.9%（正規サイトに近い分布）

PhishTankフィッシングは長期証明書（1-2年）を16.0%含み、有効期間のみでの識別には限界がある。

---

## 5. Subject Alternative Names (SAN) 分析

### 5.1 SAN数分布

| SAN数 | 正規サイト | フィッシング |
|-------|-----------|-------------|
| 1 | 20.7% | 27.2% |
| 2-5 | **70.1%** | 15.7% |
| 6-20 | 5.4% | 14.3% |
| 21-100 | 3.4% | **42.8%** |
| 100+ | 0.4% | 0.0% |

**考察**: フィッシング証明書の42.8%が21-100個のSANを含んでいる。これは動的DNSサービス（特にDuckDNS等）を利用した大量ドメイン運用パターンを示している。正規サイトの70.1%はSAN 2-5（ドメイン本体+www等）であり、分布が明確に異なる。

### 5.2 ワイルドカード証明書

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| ワイルドカード使用率 | **46.1%** | 11.3% |

**考察**: 正規サイトの約半数（46.1%）がワイルドカード証明書（`*.example.com`形式）を使用しているのに対し、フィッシングサイトは11.3%に留まる。フィッシング側の11.3%はPhishTank由来の一部に含まれるCDN/ホスティングサービスの証明書による。

### 5.3 SAN多様性指標

SAN多様性指標 = ユニークSLD数 / 総SAN数

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| SAN多様性指標（平均） | 0.472 | 0.288 |

**考察**: フィッシング証明書は同一のセカンドレベルドメイン（例: `duckdns.org`）配下に多数のサブドメインを登録するパターンが多く、多様性指標が低い。

---

## 6. 証明書チェーン特性分析

### 6.1 チェーン関連拡張の保有率

| 拡張 | 正規サイト | フィッシング | 差分 |
|------|-----------|-------------|------|
| **CRL Distribution Points** | **91.8%** | **15.4%** | **+76.4%** |
| OCSP Responder URL | 72.9% | 96.6% | -23.7% |
| Certificate Transparency SCT | 100.0% | 92.4% | +7.6% |

**重要な発見**: CRL Distribution Points（証明書失効リスト配布点）の保有率に76.4%の差異がある。Let's Encrypt証明書はCRLではなくOCSPを使用するため、フィッシング側（Let's Encrypt中心）のCRL DP保有率が低い。ただしPhishTankデータを含む場合、フィッシング側のCRL DP保有率は15.4%まで上昇する（certificates/jpcertのみでは約2%）。

**OCSP**: 正規サイトの72.9%がOCSPレスポンダURLを保有。これはLet's Encrypt以外のCAでOCSP情報が証明書に明示されない場合があるため。フィッシング側はLet's Encrypt中心のためOCSP保有率が高い（96.6%）。

---

## 7. 時間的パターン分析

### 7.1 発行曜日分布

| 曜日 | 正規サイト | フィッシング |
|------|-----------|-------------|
| 月曜 | 16.3% | 14.2% |
| 火曜 | 15.5% | 17.6% |
| 水曜 | 15.1% | 13.4% |
| 木曜 | 15.1% | 15.6% |
| 金曜 | 13.9% | 12.8% |
| 土曜 | 11.8% | 13.3% |
| 日曜 | 12.3% | 13.2% |

| 項目 | 正規サイト | フィッシング |
|------|-----------|-------------|
| 週末発行率 | 24.2% | **26.5%** |

**考察**: フィッシング証明書の週末発行率（26.5%）は正規サイト（24.2%）よりやや高いが、差は2.3ppと小さい。旧分析（サンプルベース）で報告された7.6ppの差異は、全件分析では縮小した。

### 7.2 発行時刻分布（UTC）

| 時間帯 | 正規サイト | フィッシング | 解釈 |
|--------|-----------|-------------|------|
| 深夜 (0-5時) | **36.5%** | 24.7% | 自動更新システム |
| 午前 (6-11時) | 22.4% | **33.8%** | アジア時間帯の手動発行 |
| 午後 (12-17時) | 21.3% | 29.9% | - |
| 夜間 (18-23時) | 19.8% | 11.6% | - |

**考察**:
- 正規サイトは深夜UTC（0-5時）に36.5%が集中し、自動更新システムによる定期更新パターンを示す
- フィッシングサイトは午前UTC 6-11時（アジア午後〜夕方）に33.8%が集中し、手動による証明書発行を示唆
- 時間帯分布は依然として識別に有効な特徴量だが、曜日分布の識別力は限定的

---

## 8. TLD（トップレベルドメイン）分析

### 8.1 危険TLDランキング

フィッシング率 = フィッシングドメイン数 / (フィッシング + 正規ドメイン数)

| 順位 | TLD | フィッシング率 | サンプル数 |
|------|-----|---------------|-----------|
| 1 | .gq | 100.0% | 286 |
| 2 | .ga | 99.8% | 451 |
| 3 | .ci | 98.9% | 2,014 |
| 4 | .cfd | 98.7% | 4,445 |
| 5 | .mw | 98.4% | 947 |
| 6 | .tk | 98.2% | 392 |
| 7 | .icu | 97.8% | 5,024 |
| 8 | .ml | 97.6% | 340 |
| 9 | .bar | 97.4% | 610 |
| 10 | .cn | 97.4% | 60,089 |

### 8.2 安全TLD

| TLD | フィッシング率 | サンプル数 |
|-----|---------------|-----------|
| .gov | 0.0% | 1,592 |
| .edu | 0.0% | 2,663 |
| .ie | 0.0% | 1,025 |
| .kz | 0.0% | 934 |
| .nl | 0.3% | 7,517 |
| .uk | 0.3% | 15,336 |

---

## 9. ドメイン構造分析

### 9.1 ドメイン構造統計

| 特徴 | 正規サイト | フィッシング | 差分 |
|------|-----------|-------------|------|
| ドメイン長（平均） | 14.6文字 | 21.0文字 | +6.4 |
| ドット数（平均） | 1.1 | 2.1 | +1.0 |
| サブドメイン深度（平均） | 0.1 | 1.1 | +1.0 |
| SLD長（平均） | 10.5文字 | 8.0文字 | -2.5 |
| 数字含有率 | 5.8% | 27.0% | +21.2% |

### 9.2 サブドメイン深度分布

| 深度 | 正規サイト | フィッシング |
|------|-----------|-------------|
| 0（サブドメインなし） | **90.5%** | 19.0% |
| 1 | 9.5% | **62.4%** |
| 2 | 0.0% | 8.6% |
| 3以上 | 0.0% | 10.0% |

**考察**: フィッシングサイトの81.0%がサブドメインを使用しており、正規サイト（9.5%）と大きく異なる。

---

## 10. 特徴量の識別力サマリー

分析結果に基づき、フィッシング検出に有効な特徴量を識別力順にまとめる。

### 10.1 高識別力特徴量（差分30%以上）

| 特徴量 | 正規 | フィッシング | 差分 | 識別力 |
|--------|------|-------------|------|--------|
| CRL Distribution Points保有 | 91.8% | 15.4% | 76.4% | 極めて高 |
| サブドメイン深度=0 | 90.5% | 19.0% | 71.5% | 極めて高 |
| SAN数 2-5 | 70.1% | 15.7% | 54.4% | 極めて高 |
| Let's Encrypt使用 | 39.3% | 86.3% | 47.0% | 極めて高 |
| SAN数 21-100 | 3.4% | 42.8% | 39.4% | 極めて高 |
| ワイルドカード証明書 | 46.1% | 11.3% | 34.8% | 極めて高 |

### 10.2 中識別力特徴量（差分10-30%）

| 特徴量 | 正規 | フィッシング | 差分 | 識別力 |
|--------|------|-------------|------|--------|
| OCSP保有 | 72.9% | 96.6% | 23.7% | 高 |
| 数字を含むドメイン | 5.8% | 27.0% | 21.2% | 高 |
| 90日以下の有効期間 | 77.6% | 94.7% | 17.1% | 高 |
| 1-2年の有効期間 | 15.3% | 2.6% | 12.7% | 中 |
| 深夜UTC発行 | 36.5% | 24.7% | 11.8% | 中 |

### 10.3 低識別力特徴量（差分10%未満）

| 特徴量 | 正規 | フィッシング | 差分 |
|--------|------|-------------|------|
| SCT保有 | 100.0% | 92.4% | 7.6% |
| OV/EV証明書 | 6.2% | 1.4% | 4.8% |
| Organization情報あり | 6.2% | 1.4% | 4.8% |
| 週末発行 | 24.2% | 26.5% | 2.3% |

---

## 11. 結論

本分析（全件：フィッシング364,511件、正規450,545件）により、以下の知見が得られた。

1. **証明書認証レベル**: フィッシングサイトの98.6%がDV証明書を使用し、OV/EV証明書は計1.4%と低い

2. **発行者パターン**: フィッシングサイトの86.3%がLet's Encrypt証明書を使用（日本向けデータでは91-97%、国際データでは31%と差異あり）

3. **有効期間**: フィッシングサイトの94.7%が90日以下の短期証明書を使用。ただし正規サイトも77.6%が90日以下であり、有効期間単独の識別力は中程度

4. **SAN構造**: フィッシング証明書の42.8%が21-100個のSANを持ち、動的DNSサービスの悪用パターンを示す

5. **ワイルドカード**: 正規サイトの46.1%がワイルドカード証明書を使用するのに対し、フィッシングは11.3%

6. **チェーン特性**: CRL Distribution Pointsの保有率差76.4%は最も高い識別力を持つ

7. **時間的パターン**: 発行時刻にはUTC午前（アジア時間帯）への集中が見られるが、曜日差は小さい（週末率差2.3pp）

8. **ドメイン構造**: フィッシングサイトの81.0%がサブドメインを使用し、ドメイン長も平均6.4文字長い。数字含有率は27.0% vs 5.8%で大きな差異

9. **データソースの影響**: 証明書特徴量はデータソースの地域性に強く依存する。日本向けフィッシング（certificates/jpcert）はLet's Encrypt一色（91-97%）だが、国際データ（PhishTank）では多様なCAが使用され、正規サイトとの差異が縮小する

---

## 付録A: 旧版（2026-01-12）からの主要変更点

| セクション | 項目 | 旧値 | 新値（全件実測） | 変更理由 |
|-----------|------|------|-----------------|---------|
| §1 | certificates件数 | 532,426 | 532,117 | DB実測値 |
| §1 | 分析方法 | サンプル20K-50K | **全件分析** | 精度向上 |
| §2 | フィッシングDV | 99.9% | 98.6% | PhishTank含む全件 |
| §3 | フィッシングLE率 | 97.7% | 86.3% | PhishTank含む全件 |
| §4 | 正規 平均有効期間 | 168.5日 | **153.2日** | 全件分析 |
| §4 | 正規 90日以下 | 72.1% | **77.6%** | 全件分析 |
| §4 | 正規 1-2年 | 19.7% | **15.3%** | 全件分析 |
| §4 | フィッシング 90日以下 | 98.9% | 94.7% | PhishTank含む全件 |
| §5 | フィッシング SAN 21-100 | 63.7% | 42.8% | 全件分析 |
| §5 | 正規 ワイルドカード | 55.1% | 46.1% | 全件分析 |
| §5 | フィッシング ワイルドカード | 1.5% | 11.3% | PhishTank含む全件 |
| §6 | 正規 CRL DP | 81.7% | **91.8%** | 全件分析 |
| §6 | フィッシング CRL DP | 1.6% | 15.4% | PhishTank含む全件 |
| §7 | 週末率差 | 7.6pp | **2.3pp** | 全件分析で差異縮小 |

## 付録B: 分析環境

- データベース: PostgreSQL 16.11
- 証明書パース: Python cryptography library
- 分析方法: **全件分析**（サンプリングなし）
- 分析実施日: 2026-02-06
- 証明書収集期間: 2025年3月〜2025年8月

---

**初版作成日**: 2026-01-12
**全面改訂日**: 2026-02-06（DBから直接クエリした全件実測値に基づく改訂）
